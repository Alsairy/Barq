{
  "Logging": {
    "LogLevel": {
      "Default": "Information",
      "Microsoft.AspNetCore": "Warning",
      "BARQ.Infrastructure.Security": "Information",
      "BARQ.Application.Services.Security": "Information"
    }
  },
  "AllowedHosts": "*",
  "AllowedOrigins": [
    "https://barq.app",
    "https://www.barq.app",
    "https://app.barq.com"
  ],
  "ConnectionStrings": {
    "DefaultConnection": "Server=(localdb)\\mssqllocaldb;Database=BarqDb;Trusted_Connection=true;MultipleActiveResultSets=true;TrustServerCertificate=true;",
    "Redis": "localhost:6379"
  },
  "Jwt": {
    "Key": "your-super-secret-jwt-signing-key-that-should-be-at-least-256-bits-long-for-production",
    "Issuer": "https://api.barq.app",
    "Audience": "https://barq.app",
    "ExpiryMinutes": 60,
    "RefreshTokenExpiryDays": 7
  },
  "Security": {
    "Waf": {
      "EnableSqlInjectionProtection": true,
      "EnableXssProtection": true,
      "EnableCommandInjectionProtection": true,
      "EnablePathTraversalProtection": true,
      "EnableLdapInjectionProtection": true,
      "EnableXmlInjectionProtection": true,
      "EnableSsrfProtection": true,
      "MaxRequestSizeBytes": 1048576,
      "LogBlockedRequests": true
    },
    "Headers": {
      "EnableHsts": true,
      "HstsMaxAge": 31536000,
      "EnableContentSecurityPolicy": true,
      "ContentSecurityPolicy": "default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' https:; connect-src 'self' https:; media-src 'self'; object-src 'none'; child-src 'self'; frame-ancestors 'none'; form-action 'self'; base-uri 'self'; manifest-src 'self'",
      "EnableXFrameOptions": true,
      "XFrameOptions": "DENY",
      "EnableXContentTypeOptions": true,
      "EnableXssProtection": true,
      "EnableReferrerPolicy": true,
      "ReferrerPolicy": "strict-origin-when-cross-origin",
      "EnablePermissionsPolicy": true,
      "PermissionsPolicy": "accelerometer=(), camera=(), geolocation=(), gyroscope=(), magnetometer=(), microphone=(), payment=(), usb=()",
      "EnableCrossOriginEmbedderPolicy": true,
      "EnableCrossOriginOpenerPolicy": true,
      "EnableCrossOriginResourcePolicy": true,
      "RemoveServerHeader": true,
      "RemoveXPoweredByHeader": true,
      "EnableExpectCertificateTransparency": true,
      "ExpectCtMaxAge": 86400,
      "ExpectCtReportUri": "/api/security/ct-report",
      "EnablePublicKeyPinning": false,
      "PublicKeyPins": ""
    },
    "RateLimit": {
      "EnableRateLimiting": true,
      "MaxRequestsPerWindow": 100,
      "WindowSizeSeconds": 60,
      "BlockDurationSeconds": 300,
      "EnableAdaptiveRateLimiting": true,
      "SuspiciousThresholdMultiplier": 0.8
    },
    "InputValidation": {
      "EnableInputValidation": true,
      "MaxRequestSize": 10485760,
      "MaxJsonBodySize": 1048576,
      "MaxHeaderNameLength": 100,
      "MaxHeaderValueLength": 4096,
      "MaxParameterNameLength": 100,
      "MaxParameterValueLength": 4096,
      "EnableStrictValidation": true,
      "LogInvalidRequests": true
    }
  },
  "Encryption": {
    "Provider": "AzureKeyVault",
    "AzureKeyVault": {
      "VaultUrl": "https://your-keyvault.vault.azure.net/",
      "ClientId": "",
      "ClientSecret": "",
      "TenantId": ""
    },
    "DefaultAlgorithm": "AES256",
    "KeyRotationIntervalDays": 90,
    "EnableFieldLevelEncryption": true,
    "EnableDatabaseEncryption": true
  },
  "SecurityMonitoring": {
    "EnableRealTimeMonitoring": true,
    "EnableThreatDetection": true,
    "EnableSiemIntegration": true,
    "AlertThresholds": {
      "FailedLoginAttempts": 5,
      "SuspiciousActivityScore": 75,
      "RateLimitViolations": 10
    },
    "RetentionPeriodDays": 365
  },
  "SiemIntegration": {
    "Provider": "Splunk",
    "Splunk": {
      "Endpoint": "https://your-splunk-instance.com:8088/services/collector",
      "Token": "",
      "Index": "barq_security",
      "Source": "barq_api",
      "SourceType": "json"
    },
    "EnableRealTimeForwarding": true,
    "BatchSize": 100,
    "FlushIntervalSeconds": 30
  },
  "Compliance": {
    "EnableGdprCompliance": true,
    "EnableHipaaCompliance": false,
    "EnableSoxCompliance": false,
    "DataRetentionPeriodDays": 2555,
    "EnableAutomatedReporting": true,
    "ReportingSchedule": "0 0 1 * *",
    "EnableAuditTrail": true,
    "EnableTamperProofLogging": true
  },
  "ThreatDetection": {
    "EnableBehavioralAnalysis": true,
    "EnableAnomalyDetection": true,
    "EnableMachineLearning": false,
    "SuspiciousActivityThreshold": 75,
    "AnomalyDetectionSensitivity": "Medium",
    "EnableAutomaticBlocking": false,
    "BlockDurationMinutes": 15
  }
}
